<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<style>
.r1 {font-style: italic}
.r2 {font-weight: bold}
.r3 {color: #000080; text-decoration-color: #000080; font-weight: bold}
.r4 {color: #7f7f7f; text-decoration-color: #7f7f7f; font-weight: bold}
.r5 {color: #000080; text-decoration-color: #000080; font-weight: bold; font-style: italic}
.r6 {color: #7f7f7f; text-decoration-color: #7f7f7f}
.r7 {color: #000080; text-decoration-color: #000080}
.r8 {color: #008000; text-decoration-color: #008000; background-color: #f8f8f8; font-weight: bold}
.r9 {color: #000000; text-decoration-color: #000000; background-color: #f8f8f8}
.r10 {color: #0000ff; text-decoration-color: #0000ff; background-color: #f8f8f8; font-weight: bold}
.r11 {background-color: #f8f8f8}
.r12 {color: #0000ff; text-decoration-color: #0000ff; background-color: #f8f8f8}
.r13 {color: #008000; text-decoration-color: #008000; background-color: #f8f8f8}
.r14 {color: #666666; text-decoration-color: #666666; background-color: #f8f8f8}
.r15 {color: #800000; text-decoration-color: #800000; font-weight: bold}
.r16 {color: #aa22ff; text-decoration-color: #aa22ff; background-color: #f8f8f8; font-weight: bold}
.r17 {color: #19177c; text-decoration-color: #19177c; background-color: #f8f8f8}
.r18 {color: #ba2121; text-decoration-color: #ba2121; background-color: #f8f8f8}
.r19 {color: #408080; text-decoration-color: #408080; background-color: #f8f8f8; font-style: italic}
.r20 {font-weight: bold; font-style: italic}
.r21 {color: #ba2121; text-decoration-color: #ba2121; background-color: #f8f8f8; font-style: italic}
.r22 {color: #d2413a; text-decoration-color: #d2413a; background-color: #f8f8f8; font-weight: bold}
.r23 {color: #0000ff; text-decoration-color: #0000ff}
body {
    color: #000000;
    background-color: #ffffff;
}
</style>
</head>
<html>
<body>
    <code>
        <pre style="font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span class="r1">                                           main.py: % of time =  83.18% out of  12.13s.                                            </span>
+---------------------------------------------------------------------------------------------------------------------------------+
|<span class="r2">       </span>|<span class="r3">Time</span><span class="r2">    </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r2">                                                                                                </span>|
|<span class="r2"> </span><span class="r4">Line</span><span class="r2">  </span>|<span class="r5">Python</span><span class="r2">  </span>|<span class="r5">native</span><span class="r2"> </span>|<span class="r5">system</span><span class="r2"> </span>|<span class="r2">main.py                                                                                         </span>|
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">     1 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">pygame</span><span class="r11">                                                                                  </span> |
|<span class="r6">     2 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">sys</span><span class="r11">                                                                                     </span> |
|<span class="r6">     3 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">cProfile</span><span class="r11">                                                                                </span> |
|<span class="r6">     4 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     5 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">pygame.locals</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> K_ESCAPE, QUIT, KEYDOWN, K_x</span><span class="r11">                                         </span> |
|<span class="r6">     6 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">world</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> World</span><span class="r11">                                                                        </span> |
|<span class="r6">     7 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     8 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     9 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">class</span><span class="r9"> </span><span class="r10">Engine</span><span class="r9">:</span><span class="r11">                                                                                  </span> |
|<span class="r6">    10 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">__init__</span><span class="r9">(</span><span class="r13">self</span><span class="r9">):</span><span class="r11">                                                                        </span> |
|<span class="r6">    11 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        pygame</span><span class="r14">.</span><span class="r9">init()</span><span class="r11">                                                                          </span> |
|<span class="r6">    12 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    13 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">width, </span><span class="r13">self</span><span class="r14">.</span><span class="r9">height </span><span class="r14">=</span><span class="r9"> </span><span class="r14">480</span><span class="r9">, </span><span class="r14">270</span><span class="r11">                                                     </span> |
|<span class="r6">    14 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">   1%  </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">window </span><span class="r14">=</span><span class="r9"> pygame</span><span class="r14">.</span><span class="r9">display</span><span class="r14">.</span><span class="r9">set_mode((</span><span class="r14">960</span><span class="r9">, </span><span class="r14">540</span><span class="r9">))</span><span class="r11">                                      </span> |
|<span class="r6">    15 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">display </span><span class="r14">=</span><span class="r9"> pygame</span><span class="r14">.</span><span class="r9">Surface((</span><span class="r13">self</span><span class="r14">.</span><span class="r9">width, </span><span class="r13">self</span><span class="r14">.</span><span class="r9">height))</span><span class="r11">                               </span> |
|<span class="r6">    16 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">clock </span><span class="r14">=</span><span class="r9"> pygame</span><span class="r14">.</span><span class="r9">time</span><span class="r14">.</span><span class="r9">Clock()</span><span class="r11">                                                       </span> |
|<span class="r6">    17 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    18 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">world </span><span class="r14">=</span><span class="r9"> World(</span><span class="r13">self</span><span class="r9">)</span><span class="r11">                                                               </span> |
|<span class="r6">    19 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    20 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        pygame</span><span class="r14">.</span><span class="r9">mouse</span><span class="r14">.</span><span class="r9">set_visible(</span><span class="r14">0</span><span class="r9">)</span><span class="r11">                                                            </span> |
|<span class="r6">    21 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        pygame</span><span class="r14">.</span><span class="r9">event</span><span class="r14">.</span><span class="r9">set_grab(</span><span class="r8">True</span><span class="r9">)</span><span class="r11">                                                            </span> |
|<span class="r6">    22 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    23 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">render</span><span class="r9">(</span><span class="r13">self</span><span class="r9">):</span><span class="r11">                                                                          </span> |
|<span class="r6">    24 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">render()</span><span class="r11">                                                                    </span> |
|<span class="r6">    25 </span>|<span class="r7">    7%  </span>|<span class="r7">    4% </span>|<span class="r7">   2%  </span>|<span class="r9">        pygame</span><span class="r14">.</span><span class="r9">transform</span><span class="r14">.</span><span class="r9">scale(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">display, (</span><span class="r14">960</span><span class="r9">, </span><span class="r14">540</span><span class="r9">), </span><span class="r13">self</span><span class="r14">.</span><span class="r9">window)</span><span class="r11">                          </span> |
|<span class="r6">    26 </span>|<span class="r15">   31%</span><span class="r7">  </span>|<span class="r15">   14%</span><span class="r7"> </span>|<span class="r7">  20%  </span>|<span class="r9">        pygame</span><span class="r14">.</span><span class="r9">display</span><span class="r14">.</span><span class="r9">update()</span><span class="r11">                                                                </span> |
|<span class="r6">    27 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    28 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">update_events</span><span class="r9">(</span><span class="r13">self</span><span class="r9">):</span><span class="r11">                                                                   </span> |
|<span class="r6">    29 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> event </span><span class="r16">in</span><span class="r9"> pygame</span><span class="r14">.</span><span class="r9">event</span><span class="r14">.</span><span class="r9">get():</span><span class="r11">                                                       </span> |
|<span class="r6">    30 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">if</span><span class="r9"> event</span><span class="r14">.</span><span class="r9">type</span><span class="r14">==</span><span class="r9"> QUIT:</span><span class="r11">                                                              </span> |
|<span class="r6">    31 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                pygame</span><span class="r14">.</span><span class="r9">quit()</span><span class="r11">                                                                  </span> |
|<span class="r6">    32 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                sys</span><span class="r14">.</span><span class="r9">exit()</span><span class="r11">                                                                     </span> |
|<span class="r6">    33 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">if</span><span class="r9"> event</span><span class="r14">.</span><span class="r9">type </span><span class="r14">==</span><span class="r9"> KEYDOWN:</span><span class="r11">                                                          </span> |
|<span class="r6">    34 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r8">if</span><span class="r9"> event</span><span class="r14">.</span><span class="r9">key </span><span class="r14">==</span><span class="r9"> K_ESCAPE:</span><span class="r11">                                                      </span> |
|<span class="r6">    35 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    </span><span class="r13">print</span><span class="r9">(</span><span class="r13">sum</span><span class="r9">(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">renderer</span><span class="r14">.</span><span class="r9">avg_fps) </span><span class="r14">/</span><span class="r9"> </span><span class="r13">len</span><span class="r9">(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">renderer</span><span class="r14">.</span><span class="r9">avg_fps))</span><span class="r11"> </span> |
|<span class="r6">    36 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    pygame</span><span class="r14">.</span><span class="r9">quit()</span><span class="r11">                                                              </span> |
|<span class="r6">    37 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    sys</span><span class="r14">.</span><span class="r9">exit()</span><span class="r11">                                                                 </span> |
|<span class="r6">    38 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    39 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">update</span><span class="r9">(</span><span class="r13">self</span><span class="r9">):</span><span class="r11">                                                                          </span> |
|<span class="r6">    40 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">update()</span><span class="r11">                                                                    </span> |
|<span class="r6">    41 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">update_events()</span><span class="r11">                                                                   </span> |
|<span class="r6">    42 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">clock</span><span class="r14">.</span><span class="r9">tick(</span><span class="r14">120</span><span class="r9">)</span><span class="r11">                                                                   </span> |
|<span class="r6">    43 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    44 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">run</span><span class="r9">(</span><span class="r13">self</span><span class="r9">):</span><span class="r11">                                                                             </span> |
|<span class="r6">    45 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">while</span><span class="r9"> </span><span class="r8">True</span><span class="r9">:</span><span class="r11">                                                                            </span> |
|<span class="r6">    46 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r13">self</span><span class="r14">.</span><span class="r9">render()</span><span class="r11">                                                                      </span> |
|<span class="r6">    47 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r13">self</span><span class="r14">.</span><span class="r9">display</span><span class="r14">.</span><span class="r9">fill((</span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">))</span><span class="r11">                                                       </span> |
|<span class="r6">    48 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r13">self</span><span class="r14">.</span><span class="r9">update()</span><span class="r11">                                                                      </span> |
|<span class="r6">    49 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    50 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    51 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">if</span><span class="r9"> </span><span class="r17">__name__</span><span class="r9"> </span><span class="r14">==</span><span class="r9"> </span><span class="r18">&quot;__main__&quot;</span><span class="r9">:</span><span class="r11">                                                                     </span> |
|<span class="r6">    52 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    Engine()</span><span class="r14">.</span><span class="r9">run()</span><span class="r11">                                                                             </span> |
|<span class="r6">    53 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r19"># cProfile.run(&#x27;Engine().world.update()&#x27;)</span><span class="r11">                                                  </span> |
|<span class="r6">    54 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|                                                                                                |
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r20">function summary for main.py                                                                   </span> |
|<span class="r6">    10 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">   1%  </span>|<span class="r9">Engine</span><span class="r14">.</span><span class="r12">__init__</span><span class="r11">                                                                                </span> |
|<span class="r6">    23 </span>|<span class="r15">   38%</span><span class="r7">  </span>|<span class="r15">   18%</span><span class="r7"> </span>|<span class="r7">  23%  </span>|<span class="r9">Engine</span><span class="r14">.</span><span class="r9">render</span><span class="r11">                                                                                  </span> |
|<span class="r6">    28 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Engine</span><span class="r14">.</span><span class="r9">update_events</span><span class="r11">                                                                           </span> |
|<span class="r6">    39 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Engine</span><span class="r14">.</span><span class="r9">update</span><span class="r11">                                                                                  </span> |
+---------------------------------------------------------------------------------------------------------------------------------+
<span class="r1">                 C:\Users\PC\Documents\minecraft_pygame\graphics_pipeline.py: % of time =   9.70% out of  12.13s.                  </span>
+---------------------------------------------------------------------------------------------------------------------------------+
|<span class="r2">       </span>|<span class="r3">Time</span><span class="r2">    </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r2">                                                                                                </span>|
|<span class="r2"> </span><span class="r4">Line</span><span class="r2">  </span>|<span class="r5">Python</span><span class="r2">  </span>|<span class="r5">native</span><span class="r2"> </span>|<span class="r5">system</span><span class="r2"> </span>|<span class="r2">C:\Users\PC\Documents\minecraft_pygame\graphics_pipeline.py                                     </span>|
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">     1 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">constants</span><span class="r11">                                                                               </span> |
|<span class="r6">     2 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">polygon_clipper</span><span class="r11">                                                                         </span> |
|<span class="r6">     3 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">pygame</span><span class="r11">                                                                                  </span> |
|<span class="r6">     4 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">pygame.gfxdraw</span><span class="r11">                                                                          </span> |
|<span class="r6">     5 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     6 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     7 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">time</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> time_ns</span><span class="r11">                                                                       </span> |
|<span class="r6">     8 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">pygame.draw</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> polygon </span><span class="r8">as</span><span class="r9"> draw_polygon</span><span class="r11">                                                </span> |
|<span class="r6">     9 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">matrix</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> Mat4</span><span class="r11">                                                                        </span> |
|<span class="r6">    10 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">pprint</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> pprint</span><span class="r11">                                                                      </span> |
|<span class="r6">    11 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">pygame</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> Vector3</span><span class="r11">                                                                     </span> |
|<span class="r6">    12 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">models</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> CubeData</span><span class="r11">                                                                    </span> |
|<span class="r6">    13 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    14 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    15 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">z_sort</span><span class="r9">(quad):</span><span class="r11">                                                                              </span> |
|<span class="r6">    16 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    quad </span><span class="r14">=</span><span class="r9"> quad[</span><span class="r14">0</span><span class="r9">]</span><span class="r11">                                                                             </span> |
|<span class="r6">    17 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> </span><span class="r13">sum</span><span class="r9">([v[</span><span class="r14">0</span><span class="r9">]</span><span class="r14">.</span><span class="r9">z </span><span class="r8">for</span><span class="r9"> v </span><span class="r16">in</span><span class="r9"> quad]) </span><span class="r14">/</span><span class="r9"> </span><span class="r13">len</span><span class="r9">(quad)</span><span class="r11">                                             </span> |
|<span class="r6">    18 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    19 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r21">&#x27;&#x27;&#x27;</span><span class="r11">                                                                                            </span> |
|<span class="r6">    20 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r21">1. backface culling in clip space or in object space</span><span class="r11">                                           </span> |
|<span class="r6">    21 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r21">2. depth sorting</span><span class="r11">                                                                               </span> |
|<span class="r6">    22 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r21">&#x27;&#x27;&#x27;</span><span class="r11">                                                                                            </span> |
|<span class="r6">    23 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    24 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">VECTOR_0 </span><span class="r14">=</span><span class="r9"> Vector3(</span><span class="r14">0</span><span class="r9">)</span><span class="r11">                                                                          </span> |
|<span class="r6">    25 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    26 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">class</span><span class="r9"> </span><span class="r10">Pipeline</span><span class="r9">:</span><span class="r11">                                                                                </span> |
|<span class="r6">    27 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">__init__</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, world):</span><span class="r11">                                                                 </span> |
|<span class="r6">    28 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">world </span><span class="r14">=</span><span class="r9"> world</span><span class="r11">                                                                     </span> |
|<span class="r6">    29 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">setup_projection_matrix()</span><span class="r11">                                                         </span> |
|<span class="r6">    30 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    31 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">main_matrix </span><span class="r14">=</span><span class="r9"> world</span><span class="r14">.</span><span class="r9">camera</span><span class="r14">.</span><span class="r9">get_view_matrix()</span><span class="r14">.</span><span class="r9">mat4_dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">projection_matrix)</span><span class="r11">     </span> |
|<span class="r6">    32 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    33 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cache </span><span class="r14">=</span><span class="r9"> {}</span><span class="r11">                                                                        </span> |
|<span class="r6">    34 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">sorted_polygons </span><span class="r14">=</span><span class="r9"> []</span><span class="r11">                                                              </span> |
|<span class="r6">    35 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">texture </span><span class="r14">=</span><span class="r9"> pygame</span><span class="r14">.</span><span class="r9">image</span><span class="r14">.</span><span class="r9">load(</span><span class="r18">&#x27;floor.png&#x27;</span><span class="r9">)</span><span class="r11">                                          </span> |
|<span class="r6">    36 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">texture</span><span class="r14">.</span><span class="r9">convert()</span><span class="r11">                                                                 </span> |
|<span class="r6">    37 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    38 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">setup_projection_matrix</span><span class="r9">(</span><span class="r13">self</span><span class="r9">):</span><span class="r11">                                                         </span> |
|<span class="r6">    39 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        aspect_ratio </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">engine</span><span class="r14">.</span><span class="r9">height </span><span class="r14">/</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">engine</span><span class="r14">.</span><span class="r9">width</span><span class="r11">                      </span> |
|<span class="r6">    40 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        far_near_difference </span><span class="r14">=</span><span class="r9"> constants</span><span class="r14">.</span><span class="r9">FAR_PLANE </span><span class="r14">-</span><span class="r9"> constants</span><span class="r14">.</span><span class="r9">NEAR_PLANE</span><span class="r11">                       </span> |
|<span class="r6">    41 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    42 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">projection_matrix </span><span class="r14">=</span><span class="r9"> Mat4(</span><span class="r11">                                                         </span> |
|<span class="r6">    43 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [</span><span class="r11">                                                                                  </span> |
|<span class="r6">    44 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">              [constants</span><span class="r14">.</span><span class="r9">FOV_COT </span><span class="r14">*</span><span class="r9"> aspect_ratio, </span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">],</span><span class="r11">                                     </span> |
|<span class="r6">    45 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">              [</span><span class="r14">0</span><span class="r9">, constants</span><span class="r14">.</span><span class="r9">FOV_COT, </span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">],</span><span class="r11">                                                    </span> |
|<span class="r6">    46 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">              [</span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">, (constants</span><span class="r14">.</span><span class="r9">FAR_PLANE </span><span class="r14">-</span><span class="r9"> constants</span><span class="r14">.</span><span class="r9">NEAR_PLANE) </span><span class="r14">/</span><span class="r9"> far_near_difference, </span><span class="r14">1</span><span class="r9">],</span><span class="r11">   </span> |
|<span class="r6">    47 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">              [</span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">, </span><span class="r14">-</span><span class="r9">(</span><span class="r14">2</span><span class="r9"> </span><span class="r14">*</span><span class="r9"> constants</span><span class="r14">.</span><span class="r9">FAR_PLANE </span><span class="r14">*</span><span class="r9"> constants</span><span class="r14">.</span><span class="r9">NEAR_PLANE) </span><span class="r14">/</span><span class="r9"> far_near_difference, </span><span class="r14">0</span> |
|<span class="r6">    48 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            ]</span><span class="r11">                                                                                  </span> |
|<span class="r6">    49 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                )</span><span class="r11">                                                                              </span> |
|<span class="r6">    50 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    51 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">set_light</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, light_pos):</span><span class="r11">                                                            </span> |
|<span class="r6">    52 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">light_pos </span><span class="r14">=</span><span class="r9"> Vector3(light_pos)</span><span class="r11">                                                    </span> |
|<span class="r6">    53 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">light_pos</span><span class="r14">.</span><span class="r9">normalize_ip()</span><span class="r11">                                                          </span> |
|<span class="r6">    54 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    55 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">calculate_light_value</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, normal_index):</span><span class="r11">                                             </span> |
|<span class="r6">    56 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        normal </span><span class="r14">=</span><span class="r9"> CubeData</span><span class="r14">.</span><span class="r9">NORMALS[normal_index]</span><span class="r11">                                                </span> |
|<span class="r6">    57 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        dot_value </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">light_pos</span><span class="r14">.</span><span class="r9">dot(normal)</span><span class="r11">                                                 </span> |
|<span class="r6">    58 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> </span><span class="r14">225</span><span class="r9"> </span><span class="r14">/</span><span class="r9"> </span><span class="r13">abs</span><span class="r9">(dot_value </span><span class="r14">+</span><span class="r9"> </span><span class="r14">2.4</span><span class="r9">)</span><span class="r11">                                                      </span> |
|<span class="r6">    59 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    60 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">send</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, mesh):</span><span class="r11">                                                                      </span> |
|<span class="r6">    61 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> quad, normal_index </span><span class="r16">in</span><span class="r9"> mesh:</span><span class="r11">                                                        </span> |
|<span class="r6">    62 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            normal </span><span class="r14">=</span><span class="r9"> CubeData</span><span class="r14">.</span><span class="r9">NORMALS[normal_index]</span><span class="r11">                                            </span> |
|<span class="r6">    63 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">if</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">point[</span><span class="r14">0</span><span class="r9">]</span><span class="r14">.</span><span class="r9">dot(normal) </span><span class="r14">&lt;</span><span class="r9"> normal</span><span class="r14">.</span><span class="r9">dot(quad[</span><span class="r14">0</span><span class="r9">]):</span><span class="r11">                                </span> |
|<span class="r6">    64 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r8">continue</span><span class="r11">                                                                       </span> |
|<span class="r6">    65 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r13">self</span><span class="r14">.</span><span class="r9">quad_matrix_multiply(quad, normal_index)</span><span class="r11">                                      </span> |
|<span class="r6">    66 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">sort_polygons()</span><span class="r11">                                                                   </span> |
|<span class="r6">    67 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    68 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">quad_matrix_multiply</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, quad, normal_index):</span><span class="r11">                                        </span> |
|<span class="r6">    69 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        transformed_quad </span><span class="r14">=</span><span class="r9"> []</span><span class="r11">                                                                  </span> |
|<span class="r6">    70 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> vertex </span><span class="r16">in</span><span class="r9"> quad:</span><span class="r11">                                                                    </span> |
|<span class="r6">    71 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            cache_index </span><span class="r14">=</span><span class="r9"> </span><span class="r13">tuple</span><span class="r9">(vertex)</span><span class="r11">                                                        </span> |
|<span class="r6">    72 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">if</span><span class="r9"> cache_index </span><span class="r16">not</span><span class="r9"> </span><span class="r16">in</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cache:</span><span class="r11">                                                  </span> |
|<span class="r6">    73 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cache[cache_index] </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">main_matrix</span><span class="r14">.</span><span class="r9">vec_dot(vertex)</span><span class="r11">                     </span> |
|<span class="r6">    74 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            transformed_quad</span><span class="r14">.</span><span class="r9">append(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cache[cache_index])</span><span class="r11">                                   </span> |
|<span class="r6">    75 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">clip_quad(transformed_quad, normal_index)</span><span class="r11">                                         </span> |
|<span class="r6">    76 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    77 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    78 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">clip_quad</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, quad, normal_index):</span><span class="r11">                                                   </span> |
|<span class="r6">    79 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        clipped </span><span class="r14">=</span><span class="r9"> polygon_clipper</span><span class="r14">.</span><span class="r9">clip_polygon(quad)</span><span class="r11">                                           </span> |
|<span class="r6">    80 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> clipped:  </span><span class="r19"># is empty?</span><span class="r11">                                                               </span> |
|<span class="r6">    81 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r13">self</span><span class="r14">.</span><span class="r9">sorted_polygons</span><span class="r14">.</span><span class="r9">append((clipped, normal_index))</span><span class="r11">                               </span> |
|<span class="r6">    82 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    83 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">sort_polygons</span><span class="r9">(</span><span class="r13">self</span><span class="r9">):</span><span class="r11">                                                                   </span> |
|<span class="r6">    84 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">sorted_polygons</span><span class="r14">.</span><span class="r9">sort(key</span><span class="r14">=</span><span class="r9">z_sort, reverse</span><span class="r14">=</span><span class="r8">True</span><span class="r9">)</span><span class="r11">                                    </span> |
|<span class="r6">    85 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> polygon, normal_index </span><span class="r16">in</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">sorted_polygons:</span><span class="r11">                                     </span> |
|<span class="r6">    86 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            light_value </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">calculate_light_value(normal_index)</span><span class="r11">                             </span> |
|<span class="r6">    87 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            color </span><span class="r14">=</span><span class="r9"> (light_value, ) </span><span class="r14">*</span><span class="r9"> </span><span class="r14">3</span><span class="r11">                                                        </span> |
|<span class="r6">    88 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r13">self</span><span class="r14">.</span><span class="r9">rasterize_polygon(polygon, color)</span><span class="r11">                                             </span> |
|<span class="r6">    89 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    90 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">rasterize_polygon</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, polygon, color</span><span class="r14">=</span><span class="r9">(</span><span class="r14">255</span><span class="r9">, </span><span class="r14">255</span><span class="r9">, </span><span class="r14">255</span><span class="r9">)):</span><span class="r11">                               </span> |
|<span class="r6">    91 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        screen_polygon </span><span class="r14">=</span><span class="r9"> []</span><span class="r11">                                                                    </span> |
|<span class="r6">    92 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> vertex </span><span class="r16">in</span><span class="r9"> polygon:</span><span class="r11">                                                                 </span> |
|<span class="r6">    93 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            w </span><span class="r14">=</span><span class="r9"> vertex[</span><span class="r14">1</span><span class="r9">]</span><span class="r11">                                                                      </span> |
|<span class="r6">    94 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">if</span><span class="r9"> w </span><span class="r14">==</span><span class="r9"> </span><span class="r14">0</span><span class="r9">:</span><span class="r11">                                                                         </span> |
|<span class="r6">    95 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                w </span><span class="r14">=</span><span class="r9"> </span><span class="r14">0.00001</span><span class="r11">                                                                    </span> |
|<span class="r6">    96 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            ndc_vec </span><span class="r14">=</span><span class="r9"> vertex[</span><span class="r14">0</span><span class="r9">] </span><span class="r14">/</span><span class="r9"> w  </span><span class="r19"># normalize device coordinates</span><span class="r11">                            </span> |
|<span class="r6">    97 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            screen_point </span><span class="r14">=</span><span class="r9"> [(ndc_vec</span><span class="r14">.</span><span class="r9">x </span><span class="r14">+</span><span class="r9"> </span><span class="r14">1</span><span class="r9">) </span><span class="r14">*</span><span class="r9"> </span><span class="r14">240</span><span class="r9">, (ndc_vec</span><span class="r14">.</span><span class="r9">y </span><span class="r14">+</span><span class="r9"> </span><span class="r14">1</span><span class="r9">) </span><span class="r14">*</span><span class="r9"> </span><span class="r14">135</span><span class="r9">]</span><span class="r11">                      </span> |
|<span class="r6">    98 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            screen_polygon</span><span class="r14">.</span><span class="r9">append(screen_point)</span><span class="r11">                                                </span> |
|<span class="r6">    99 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r19"># draw_polygon(self.world.engine.display, color, screen_polygon, width=4)</span><span class="r11">              </span> |
|<span class="r6">   100 </span>|<span class="r7">    1%  </span>|<span class="r7">       </span>|<span class="r7">   2%  </span>|<span class="r9">        draw_polygon(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">engine</span><span class="r14">.</span><span class="r9">display, color, screen_polygon, width</span><span class="r14">=0</span><span class="r9">)</span><span class="r11">                </span> |
|<span class="r6">   101 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   102 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">update</span><span class="r9">(</span><span class="r13">self</span><span class="r9">):</span><span class="r11">                                                                          </span> |
|<span class="r6">   103 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cache</span><span class="r14">.</span><span class="r9">clear()</span><span class="r11">                                                                     </span> |
|<span class="r6">   104 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">sorted_polygons</span><span class="r14">.</span><span class="r9">clear()</span><span class="r11">                                                           </span> |
|<span class="r6">   105 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   106 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">view_matrix </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">camera</span><span class="r14">.</span><span class="r9">get_view_matrix()</span><span class="r11">                                 </span> |
|<span class="r6">   107 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">main_matrix </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">view_matrix</span><span class="r14">.</span><span class="r9">mat4_dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">projection_matrix)</span><span class="r11">                   </span> |
|<span class="r6">   108 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">point </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">world</span><span class="r14">.</span><span class="r9">camera</span><span class="r14">.</span><span class="r9">world_matrix</span><span class="r14">.</span><span class="r9">vec_dot(VECTOR_0)</span><span class="r11">                          </span> |
|<span class="r6">   109 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|                                                                                                |
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r20">function summary for C:\Users\PC\Documents\minecraft_pygame\graphics_pipeline.py               </span> |
|<span class="r6">    15 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">z_sort</span><span class="r11">                                                                                </span> |
|<span class="r6">    55 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">calculate_light_value</span><span class="r11">                                                                 </span> |
|<span class="r6">    60 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">send</span><span class="r11">                                                                                  </span> |
|<span class="r6">    68 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">quad_matrix_multiply</span><span class="r11">                                                                  </span> |
|<span class="r6">    78 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">clip_quad</span><span class="r11">                                                                             </span> |
|<span class="r6">    83 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">sort_polygons</span><span class="r11">                                                                         </span> |
|<span class="r6">    90 </span>|<span class="r7">    2%  </span>|<span class="r7">       </span>|<span class="r7">   2%  </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">rasterize_polygon</span><span class="r11">                                                                     </span> |
+---------------------------------------------------------------------------------------------------------------------------------+
<span class="r1">                  C:\Users\PC\Documents\minecraft_pygame\polygon_clipper.py: % of time =   3.10% out of  12.13s.                   </span>
+---------------------------------------------------------------------------------------------------------------------------------+
|<span class="r2">       </span>|<span class="r3">Time</span><span class="r2">    </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r2">                                                                                                </span>|
|<span class="r2"> </span><span class="r4">Line</span><span class="r2">  </span>|<span class="r5">Python</span><span class="r2">  </span>|<span class="r5">native</span><span class="r2"> </span>|<span class="r5">system</span><span class="r2"> </span>|<span class="r2">C:\Users\PC\Documents\minecraft_pygame\polygon_clipper.py                                       </span>|
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">     1 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">W_CLIPPING_PLANE </span><span class="r14">=</span><span class="r9"> </span><span class="r14">0.0001</span><span class="r11">                                                                      </span> |
|<span class="r6">     2 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     3 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     4 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">clip_to_plane</span><span class="r9">(vertices, component, component_factor):</span><span class="r11">                                      </span> |
|<span class="r6">     5 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    clipped_polygon </span><span class="r14">=</span><span class="r9"> []</span><span class="r11">                                                                       </span> |
|<span class="r6">     6 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    previous_vertex </span><span class="r14">=</span><span class="r9"> vertices[</span><span class="r14">-1</span><span class="r9">]</span><span class="r11">                                                             </span> |
|<span class="r6">     7 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    previous_component </span><span class="r14">=</span><span class="r9"> previous_vertex[</span><span class="r14">0</span><span class="r9">][component] </span><span class="r14">*</span><span class="r9"> component_factor</span><span class="r11">                      </span> |
|<span class="r6">     8 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    previous_inside </span><span class="r14">=</span><span class="r9"> previous_component </span><span class="r14">&lt;=</span><span class="r9"> previous_vertex[</span><span class="r14">1</span><span class="r9">]</span><span class="r11">                                 </span> |
|<span class="r6">     9 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r11">                                                                                           </span> |
|<span class="r6">    10 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">for</span><span class="r9"> current_vertex </span><span class="r16">in</span><span class="r9"> vertices:</span><span class="r11">                                                            </span> |
|<span class="r6">    11 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        current_component </span><span class="r14">=</span><span class="r9"> current_vertex[</span><span class="r14">0</span><span class="r9">][component] </span><span class="r14">*</span><span class="r9"> component_factor</span><span class="r11">                    </span> |
|<span class="r6">    12 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        current_inside </span><span class="r14">=</span><span class="r9"> current_component </span><span class="r14">&lt;=</span><span class="r9"> current_vertex[</span><span class="r14">1</span><span class="r9">]</span><span class="r11">                                </span> |
|<span class="r6">    13 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    14 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> current_inside </span><span class="r14">^</span><span class="r9"> previous_inside:</span><span class="r11">                                                   </span> |
|<span class="r6">    15 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            differ </span><span class="r14">=</span><span class="r9"> (previous_vertex[</span><span class="r14">1</span><span class="r9">] </span><span class="r14">-</span><span class="r9"> previous_component)</span><span class="r11">                                 </span> |
|<span class="r6">    16 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            t </span><span class="r14">=</span><span class="r9"> (differ </span><span class="r14">/</span><span class="r9"> (differ </span><span class="r14">-</span><span class="r9"> (current_vertex[</span><span class="r14">1</span><span class="r9">] </span><span class="r14">-</span><span class="r9"> current_component)))</span><span class="r11">                  </span> |
|<span class="r6">    17 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    18 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            intersection </span><span class="r14">=</span><span class="r9"> previous_vertex[</span><span class="r14">0</span><span class="r9">] </span><span class="r14">+</span><span class="r9"> t </span><span class="r14">*</span><span class="r9"> (current_vertex[</span><span class="r14">0</span><span class="r9">] </span><span class="r14">-</span><span class="r9"> previous_vertex[</span><span class="r14">0</span><span class="r9">])</span><span class="r11">   </span> |
|<span class="r6">    19 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            w </span><span class="r14">=</span><span class="r9"> previous_vertex[</span><span class="r14">1</span><span class="r9">] </span><span class="r14">+</span><span class="r9"> t </span><span class="r14">*</span><span class="r9"> (current_vertex[</span><span class="r14">1</span><span class="r9">] </span><span class="r14">-</span><span class="r9"> previous_vertex[</span><span class="r14">1</span><span class="r9">])</span><span class="r11">              </span> |
|<span class="r6">    20 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            clipped_polygon</span><span class="r14">.</span><span class="r9">append((intersection, w))</span><span class="r11">                                          </span> |
|<span class="r6">    21 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    22 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> current_inside:</span><span class="r11">                                                                     </span> |
|<span class="r6">    23 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            clipped_polygon</span><span class="r14">.</span><span class="r9">append(current_vertex)</span><span class="r11">                                             </span> |
|<span class="r6">    24 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    25 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        previous_vertex </span><span class="r14">=</span><span class="r9"> current_vertex</span><span class="r11">                                                       </span> |
|<span class="r6">    26 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        previous_component </span><span class="r14">=</span><span class="r9"> current_component</span><span class="r11">                                                 </span> |
|<span class="r6">    27 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        previous_inside </span><span class="r14">=</span><span class="r9"> current_inside</span><span class="r11">                                                       </span> |
|<span class="r6">    28 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> clipped_polygon</span><span class="r11">                                                                     </span> |
|<span class="r6">    29 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    30 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">is_inside_frustum</span><span class="r9">(vec):</span><span class="r11">                                                                    </span> |
|<span class="r6">    31 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    w </span><span class="r14">=</span><span class="r9"> </span><span class="r13">abs</span><span class="r9">(vec[</span><span class="r14">1</span><span class="r9">])</span><span class="r11">                                                                            </span> |
|<span class="r6">    32 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    vec3 </span><span class="r14">=</span><span class="r9"> vec[</span><span class="r14">0</span><span class="r9">]</span><span class="r11">                                                                              </span> |
|<span class="r6">    33 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> </span><span class="r13">abs</span><span class="r9">(vec3</span><span class="r14">.</span><span class="r9">x) </span><span class="r14">&lt;=</span><span class="r9"> w </span><span class="r16">and</span><span class="r9"> </span><span class="r13">abs</span><span class="r9">(vec3</span><span class="r14">.</span><span class="r9">y) </span><span class="r14">&lt;=</span><span class="r9"> w </span><span class="r16">and</span><span class="r9"> </span><span class="r13">abs</span><span class="r9">(vec3</span><span class="r14">.</span><span class="r9">z) </span><span class="r14">&lt;=</span><span class="r9"> w</span><span class="r11">                          </span> |
|<span class="r6">    34 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    35 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">clip_polygon</span><span class="r9">(vertices):</span><span class="r11">                                                                    </span> |
|<span class="r6">    36 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    37 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    inside_frustum </span><span class="r14">=</span><span class="r9"> [is_inside_frustum(vertex) </span><span class="r8">for</span><span class="r9"> vertex </span><span class="r16">in</span><span class="r9"> vertices]</span><span class="r11">                        </span> |
|<span class="r6">    38 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">if</span><span class="r9"> </span><span class="r13">all</span><span class="r9">(inside_frustum):</span><span class="r11">                                                                    </span> |
|<span class="r6">    39 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> vertices</span><span class="r11">                                                                        </span> |
|<span class="r6">    40 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    clipped </span><span class="r14">=</span><span class="r9"> vertices</span><span class="r11">                                                                         </span> |
|<span class="r6">    41 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">for</span><span class="r9"> axis </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r14">3</span><span class="r9">):</span><span class="r11">                                                                      </span> |
|<span class="r6">    42 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        clipped </span><span class="r14">=</span><span class="r9"> clip_to_plane(clipped, axis, </span><span class="r14">1</span><span class="r9">)</span><span class="r11">                                              </span> |
|<span class="r6">    43 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> clipped:</span><span class="r11">                                                                            </span> |
|<span class="r6">    44 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            clipped </span><span class="r14">=</span><span class="r9"> clip_to_plane(clipped, axis, </span><span class="r14">-1</span><span class="r9">)</span><span class="r11">                                         </span> |
|<span class="r6">    45 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> </span><span class="r16">not</span><span class="r9"> clipped:</span><span class="r11">                                                                        </span> |
|<span class="r6">    46 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">break</span><span class="r11">                                                                              </span> |
|<span class="r6">    47 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> clipped</span><span class="r11">                                                                             </span> |
|<span class="r6">    48 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    49 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">if</span><span class="r9"> </span><span class="r16">not</span><span class="r9"> vertices:</span><span class="r11">                                                                           </span> |
|<span class="r6">    50 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r11">                                                                                 </span> |
|<span class="r6">    51 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    52 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    inside_frustum </span><span class="r14">=</span><span class="r9"> [is_inside_frustum(vertex) </span><span class="r8">for</span><span class="r9"> vertex </span><span class="r16">in</span><span class="r9"> vertices]</span><span class="r11">                        </span> |
|<span class="r6">    53 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">if</span><span class="r9"> </span><span class="r13">all</span><span class="r9">(inside_frustum):</span><span class="r11">                                                                    </span> |
|<span class="r6">    54 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> vertices</span><span class="r11">                                                                        </span> |
|<span class="r6">    55 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    polygon </span><span class="r14">=</span><span class="r9"> clip_to_plane(vertices, axis, </span><span class="r14">1</span><span class="r9">)</span><span class="r11">                                                 </span> |
|<span class="r6">    56 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">if</span><span class="r9"> polygon </span><span class="r16">and</span><span class="r9"> axis </span><span class="r16">not</span><span class="r9"> </span><span class="r16">in</span><span class="r9"> []: </span><span class="r11">                                                            </span> |
|<span class="r6">    57 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> clip_to_plane(polygon, axis, </span><span class="r14">-1</span><span class="r9">)</span><span class="r11">                                                </span> |
|<span class="r6">    58 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> polygon</span><span class="r11">                                                                             </span> |
|<span class="r6">    59 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|                                                                                                |
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r20">function summary for C:\Users\PC\Documents\minecraft_pygame\polygon_clipper.py                 </span> |
|<span class="r6">     4 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">clip_to_plane</span><span class="r11">                                                                         </span> |
|<span class="r6">    30 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">is_inside_frustum</span><span class="r11">                                                                     </span> |
|<span class="r6">    35 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Pipeline</span><span class="r14">.</span><span class="r9">clip_polygon</span><span class="r11">                                                                          </span> |
+---------------------------------------------------------------------------------------------------------------------------------+
<span class="r1">                     C:\Users\PC\Documents\minecraft_pygame\chunk_sys.py: % of time =   1.83% out of  12.13s.                      </span>
+---------------------------------------------------------------------------------------------------------------------------------+
|<span class="r2">       </span>|<span class="r3">Time</span><span class="r2">    </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r2">                                                                                                </span>|
|<span class="r2"> </span><span class="r4">Line</span><span class="r2">  </span>|<span class="r5">Python</span><span class="r2">  </span>|<span class="r5">native</span><span class="r2"> </span>|<span class="r5">system</span><span class="r2"> </span>|<span class="r2">C:\Users\PC\Documents\minecraft_pygame\chunk_sys.py                                             </span>|
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">     1 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">json</span><span class="r11">                                                                                    </span> |
|<span class="r6">     2 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">random</span><span class="r11">                                                                                  </span> |
|<span class="r6">     3 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     4 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">models</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> Voxel</span><span class="r11">                                                                       </span> |
|<span class="r6">     5 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">pygame</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> Vector3</span><span class="r11">                                                                     </span> |
|<span class="r6">     6 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     7 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     8 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     9 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">class</span><span class="r9"> </span><span class="r10">ChunkSys</span><span class="r9">:</span><span class="r11">                                                                                </span> |
|<span class="r6">    10 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r17">__slots__</span><span class="r9"> </span><span class="r14">=</span><span class="r9"> [</span><span class="r18">&#x27;chunk_size&#x27;</span><span class="r9">, </span><span class="r18">&#x27;chunks&#x27;</span><span class="r9">, </span><span class="r18">&#x27;voxel_data&#x27;</span><span class="r9">, </span><span class="r18">&#x27;mesh_buffer&#x27;</span><span class="r9">]</span><span class="r11">                          </span> |
|<span class="r6">    11 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    12 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">__init__</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, chunk_size</span><span class="r14">=8</span><span class="r9">):</span><span class="r11">                                                          </span> |
|<span class="r6">    13 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size </span><span class="r14">=</span><span class="r9"> chunk_size</span><span class="r11">                                                           </span> |
|<span class="r6">    14 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks </span><span class="r14">=</span><span class="r9"> {}</span><span class="r11">                                                                       </span> |
|<span class="r6">    15 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">mesh_buffer </span><span class="r14">=</span><span class="r9"> {}</span><span class="r11">                                                                  </span> |
|<span class="r6">    16 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    17 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">generate_chunk</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, chunk_pos):</span><span class="r11">                                                       </span> |
|<span class="r6">    18 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        index </span><span class="r14">=</span><span class="r9"> </span><span class="r13">tuple</span><span class="r9">(chunk_pos)</span><span class="r11">                                                               </span> |
|<span class="r6">    19 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks[index] </span><span class="r14">=</span><span class="r9"> {}</span><span class="r11">                                                                </span> |
|<span class="r6">    20 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> x </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size):</span><span class="r11">                                                       </span> |
|<span class="r6">    21 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">for</span><span class="r9"> y </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size):</span><span class="r11">                                                   </span> |
|<span class="r6">    22 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r8">for</span><span class="r9"> z </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size):</span><span class="r11">                                               </span> |
|<span class="r6">    23 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    block_pos </span><span class="r14">=</span><span class="r9"> (x </span><span class="r14">+</span><span class="r9"> chunk_pos[</span><span class="r14">0</span><span class="r9">],</span><span class="r11">                                             </span> |
|<span class="r6">    24 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                 y </span><span class="r14">+</span><span class="r9"> chunk_pos[</span><span class="r14">1</span><span class="r9">],</span><span class="r11">                                             </span> |
|<span class="r6">    25 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                 z </span><span class="r14">+</span><span class="r9"> chunk_pos[</span><span class="r14">2</span><span class="r9">])</span><span class="r11">                                             </span> |
|<span class="r6">    26 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    </span><span class="r13">self</span><span class="r14">.</span><span class="r9">add_block(block_pos, Voxel())</span><span class="r11">                                         </span> |
|<span class="r6">    27 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    28 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">pos_to_chunk_scale</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, pos):</span><span class="r11">                                                         </span> |
|<span class="r6">    29 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> (</span><span class="r11">                                                                               </span> |
|<span class="r6">    30 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r13">int</span><span class="r9">(pos[</span><span class="r14">0</span><span class="r9">] </span><span class="r14">//</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size),</span><span class="r11">                                                </span> |
|<span class="r6">    31 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r13">int</span><span class="r9">(pos[</span><span class="r14">1</span><span class="r9">] </span><span class="r14">//</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size),</span><span class="r11">                                                </span> |
|<span class="r6">    32 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r13">int</span><span class="r9">(pos[</span><span class="r14">2</span><span class="r9">] </span><span class="r14">//</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size)</span><span class="r11">                                                 </span> |
|<span class="r6">    33 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                )</span><span class="r11">                                                                              </span> |
|<span class="r6">    34 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    35 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">add_block</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, pos, block):</span><span class="r11">                                                           </span> |
|<span class="r6">    36 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        chunk_pos </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">pos_to_chunk_scale(pos)</span><span class="r11">                                               </span> |
|<span class="r6">    37 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        index </span><span class="r14">=</span><span class="r9"> </span><span class="r13">tuple</span><span class="r9">(chunk_pos)</span><span class="r11">                                                               </span> |
|<span class="r6">    38 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> chunk_pos </span><span class="r16">not</span><span class="r9"> </span><span class="r16">in</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks:</span><span class="r11">                                                       </span> |
|<span class="r6">    39 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks[index] </span><span class="r14">=</span><span class="r9"> {}</span><span class="r11">                                                            </span> |
|<span class="r6">    40 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    41 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        x, y, z </span><span class="r14">=</span><span class="r9"> pos</span><span class="r11">                                                                          </span> |
|<span class="r6">    42 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        chunk_area </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks[chunk_pos]</span><span class="r11">                                                    </span> |
|<span class="r6">    43 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> x </span><span class="r16">in</span><span class="r9"> chunk_area:</span><span class="r11">                                                                    </span> |
|<span class="r6">    44 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">if</span><span class="r9"> y </span><span class="r16">in</span><span class="r9"> chunk_area[x]:</span><span class="r11">                                                             </span> |
|<span class="r6">    45 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                chunk_area[x][y][z] </span><span class="r14">=</span><span class="r9"> block</span><span class="r11">                                                    </span> |
|<span class="r6">    46 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">else</span><span class="r9">:</span><span class="r11">                                                                              </span> |
|<span class="r6">    47 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                chunk_area[x][y] </span><span class="r14">=</span><span class="r9"> {z: block}</span><span class="r11">                                                  </span> |
|<span class="r6">    48 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">else</span><span class="r9">:</span><span class="r11">                                                                                  </span> |
|<span class="r6">    49 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            chunk_area[x] </span><span class="r14">=</span><span class="r9"> {y: {z: block}}</span><span class="r11">                                                    </span> |
|<span class="r6">    50 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    51 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">get_block</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, pos):</span><span class="r11">                                                                  </span> |
|<span class="r6">    52 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        chunk_pos </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">pos_to_chunk_scale(pos)</span><span class="r11">                                               </span> |
|<span class="r6">    53 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> chunk_pos </span><span class="r16">not</span><span class="r9"> </span><span class="r16">in</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks:</span><span class="r11">                                                       </span> |
|<span class="r6">    54 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">return</span><span class="r9"> </span><span class="r8">None</span><span class="r11">                                                                        </span> |
|<span class="r6">    55 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        x, y, z </span><span class="r14">=</span><span class="r9"> pos</span><span class="r11">                                                                          </span> |
|<span class="r6">    56 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">try</span><span class="r9">:</span><span class="r11">                                                                                   </span> |
|<span class="r6">    57 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            block </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks[chunk_pos][x][y][z]</span><span class="r11">                                            </span> |
|<span class="r6">    58 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">except</span><span class="r9"> </span><span class="r22">KeyError</span><span class="r9">:</span><span class="r11">                                                                       </span> |
|<span class="r6">    59 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">return</span><span class="r9"> </span><span class="r8">None</span><span class="r11">                                                                        </span> |
|<span class="r6">    60 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> block</span><span class="r11">                                                                           </span> |
|<span class="r6">    61 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    62 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    63 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">get_chunk</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, chunk_pos):</span><span class="r11">                                                            </span> |
|<span class="r6">    64 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> chunk_pos </span><span class="r16">not</span><span class="r9"> </span><span class="r16">in</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks:</span><span class="r11">                                                       </span> |
|<span class="r6">    65 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">return</span><span class="r9"> </span><span class="r8">False</span><span class="r11">                                                                       </span> |
|<span class="r6">    66 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        chunk </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks[chunk_pos]</span><span class="r11">                                                         </span> |
|<span class="r6">    67 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> x </span><span class="r16">in</span><span class="r9"> chunk:</span><span class="r11">                                                                        </span> |
|<span class="r6">    68 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">for</span><span class="r9"> y </span><span class="r16">in</span><span class="r9"> chunk[x]:</span><span class="r11">                                                                 </span> |
|<span class="r6">    69 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r8">for</span><span class="r9"> z </span><span class="r16">in</span><span class="r9"> chunk[x][y]:</span><span class="r11">                                                          </span> |
|<span class="r6">    70 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    data </span><span class="r14">=</span><span class="r9"> (x, y, z, </span><span class="r14">0</span><span class="r9">), chunk[x][y][z]</span><span class="r11">                                        </span> |
|<span class="r6">    71 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    </span><span class="r8">if</span><span class="r9"> data[</span><span class="r14">1</span><span class="r9">]</span><span class="r14">.</span><span class="r9">is_active:</span><span class="r11">                                                      </span> |
|<span class="r6">    72 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r8">yield</span><span class="r9"> data</span><span class="r11">                                                             </span> |
|<span class="r6">    73 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    74 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">get_block_in_chunk</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, chunk_pos, block_pos):</span><span class="r11">                                        </span> |
|<span class="r6">    75 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        chunk_pos </span><span class="r14">=</span><span class="r9"> </span><span class="r13">tuple</span><span class="r9">(chunk_pos)</span><span class="r11">                                                           </span> |
|<span class="r6">    76 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> chunk_pos </span><span class="r16">not</span><span class="r9"> </span><span class="r16">in</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks:</span><span class="r11">                                                       </span> |
|<span class="r6">    77 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">return</span><span class="r9"> </span><span class="r8">None</span><span class="r11">                                                                        </span> |
|<span class="r6">    78 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        x, y, z </span><span class="r14">=</span><span class="r9"> block_pos</span><span class="r11">                                                                    </span> |
|<span class="r6">    79 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">try</span><span class="r9">:</span><span class="r11">                                                                                   </span> |
|<span class="r6">    80 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            block </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks[chunk_pos][x][y][z]</span><span class="r11">                                            </span> |
|<span class="r6">    81 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">except</span><span class="r9"> </span><span class="r22">KeyError</span><span class="r9">:</span><span class="r11">                                                                       </span> |
|<span class="r6">    82 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">return</span><span class="r9"> </span><span class="r8">None</span><span class="r11">                                                                        </span> |
|<span class="r6">    83 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> block</span><span class="r11">                                                                           </span> |
|<span class="r6">    84 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    85 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">get_quad_normal_index</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, axis, mask):</span><span class="r11">                                               </span> |
|<span class="r6">    86 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> (axis </span><span class="r14">&lt;&lt;</span><span class="r9"> </span><span class="r14">1</span><span class="r9">) </span><span class="r14">+</span><span class="r9"> </span><span class="r13">max</span><span class="r9">(mask, </span><span class="r14">0</span><span class="r9">)</span><span class="r11">                                                      </span> |
|<span class="r6">    87 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    88 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">greedy_mesh</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, chunk_pos):</span><span class="r11">                                                          </span> |
|<span class="r6">    89 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    90 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        chunk_pos </span><span class="r14">=</span><span class="r9"> Vector3(chunk_pos)</span><span class="r11">                                                         </span> |
|<span class="r6">    91 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        quads </span><span class="r14">=</span><span class="r9"> []</span><span class="r11">                                                                             </span> |
|<span class="r6">    92 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        dims </span><span class="r14">=</span><span class="r9"> [</span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size] </span><span class="r14">*</span><span class="r9"> </span><span class="r14">3</span><span class="r11">                                                           </span> |
|<span class="r6">    93 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        block_offset </span><span class="r14">=</span><span class="r9"> chunk_pos </span><span class="r14">*</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunk_size</span><span class="r11">                                             </span> |
|<span class="r6">    94 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    95 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> axis </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r14">3</span><span class="r9">):</span><span class="r11">                                                                  </span> |
|<span class="r6">    96 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            axis1 </span><span class="r14">=</span><span class="r9"> (axis </span><span class="r14">+</span><span class="r9"> </span><span class="r14">1</span><span class="r9">) </span><span class="r14">%</span><span class="r9"> </span><span class="r14">3</span><span class="r11">                                                             </span> |
|<span class="r6">    97 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            axis2 </span><span class="r14">=</span><span class="r9"> (axis </span><span class="r14">+</span><span class="r9"> </span><span class="r14">2</span><span class="r9">) </span><span class="r14">%</span><span class="r9"> </span><span class="r14">3</span><span class="r11">                                                             </span> |
|<span class="r6">    98 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    99 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            direction </span><span class="r14">=</span><span class="r9"> Vector3([</span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">])</span><span class="r11">                                                     </span> |
|<span class="r6">   100 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            pos </span><span class="r14">=</span><span class="r9"> Vector3([</span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">, </span><span class="r14">0</span><span class="r9">])</span><span class="r11">                                                           </span> |
|<span class="r6">   101 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            mask </span><span class="r14">=</span><span class="r9"> [</span><span class="r14">0</span><span class="r9">] </span><span class="r14">*</span><span class="r9"> dims[axis1] </span><span class="r14">*</span><span class="r9"> (dims[axis2])</span><span class="r11">                                           </span> |
|<span class="r6">   102 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            direction[axis] </span><span class="r14">=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                                </span> |
|<span class="r6">   103 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   104 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            pos[axis] </span><span class="r14">=</span><span class="r9"> </span><span class="r14">-1</span><span class="r11">                                                                     </span> |
|<span class="r6">   105 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">while</span><span class="r9"> pos[axis] </span><span class="r14">&lt;</span><span class="r9"> dims[axis]:</span><span class="r11">                                                      </span> |
|<span class="r6">   106 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                n </span><span class="r14">=</span><span class="r9"> </span><span class="r14">0</span><span class="r11">                                                                          </span> |
|<span class="r6">   107 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r8">for</span><span class="r9"> pos[axis2] </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(dims[axis2]):</span><span class="r11">                                          </span> |
|<span class="r6">   108 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    </span><span class="r8">for</span><span class="r9"> pos[axis1] </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(dims[axis1]):</span><span class="r11">                                      </span> |
|<span class="r6">   109 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        block1, block2 </span><span class="r14">=</span><span class="r9"> </span><span class="r8">False</span><span class="r9">, </span><span class="r8">False</span><span class="r11">                                          </span> |
|<span class="r6">   110 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        block_pos </span><span class="r14">=</span><span class="r9"> pos </span><span class="r14">+</span><span class="r9"> block_offset</span><span class="r11">                                         </span> |
|<span class="r6">   111 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r8">if</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">get_block(block_pos):</span><span class="r11">                                          </span> |
|<span class="r6">   112 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            block1 </span><span class="r14">=</span><span class="r9"> </span><span class="r8">True</span><span class="r9">  </span><span class="r19"># pos[axis] &gt;= 0</span><span class="r11">                                    </span> |
|<span class="r6">   113 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r8">if</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">get_block(block_pos </span><span class="r14">+</span><span class="r9"> direction):</span><span class="r11">                              </span> |
|<span class="r6">   114 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            block2 </span><span class="r14">=</span><span class="r9"> </span><span class="r8">True</span><span class="r9">  </span><span class="r19"># pos[axis] &lt; dims[axis]</span><span class="r11">                            </span> |
|<span class="r6">   115 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r8">if</span><span class="r9"> block1 </span><span class="r16">is</span><span class="r9"> block2:</span><span class="r11">                                                   </span> |
|<span class="r6">   116 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            mask[n] </span><span class="r14">=</span><span class="r9"> </span><span class="r14">0</span><span class="r11">                                                        </span> |
|<span class="r6">   117 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r8">elif</span><span class="r9"> block1:</span><span class="r11">                                                           </span> |
|<span class="r6">   118 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            mask[n] </span><span class="r14">=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                        </span> |
|<span class="r6">   119 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r8">else</span><span class="r9">:</span><span class="r11">                                                                  </span> |
|<span class="r6">   120 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            mask[n] </span><span class="r14">=</span><span class="r9"> </span><span class="r14">-1</span><span class="r11">                                                       </span> |
|<span class="r6">   121 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r19"># mask[n] = block1 ^ block2</span><span class="r11">                                            </span> |
|<span class="r6">   122 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        n </span><span class="r14">+=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                                 </span> |
|<span class="r6">   123 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   124 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                pos[axis] </span><span class="r14">+=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                                 </span> |
|<span class="r6">   125 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                n </span><span class="r14">=</span><span class="r9"> </span><span class="r14">0</span><span class="r11">                                                                          </span> |
|<span class="r6">   126 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r8">for</span><span class="r9"> j </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(dims[axis2]):</span><span class="r11">                                                   </span> |
|<span class="r6">   127 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    i </span><span class="r14">=</span><span class="r9"> </span><span class="r14">0</span><span class="r11">                                                                      </span> |
|<span class="r6">   128 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    </span><span class="r8">while</span><span class="r9"> i </span><span class="r14">&lt;</span><span class="r9"> dims[axis1]:</span><span class="r11">                                                     </span> |
|<span class="r6">   129 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        current_mask </span><span class="r14">=</span><span class="r9"> mask[n]</span><span class="r11">                                                 </span> |
|<span class="r6">   130 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r8">if</span><span class="r9"> current_mask:</span><span class="r11">                                                       </span> |
|<span class="r6">   131 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            w </span><span class="r14">=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                              </span> |
|<span class="r6">   132 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            </span><span class="r8">while</span><span class="r9"> (i </span><span class="r14">+</span><span class="r9"> w) </span><span class="r14">&lt;</span><span class="r9"> dims[axis1] </span><span class="r16">and</span><span class="r9"> mask[n </span><span class="r14">+</span><span class="r9"> w] </span><span class="r14">==</span><span class="r9"> current_mask:</span><span class="r11">       </span> |
|<span class="r6">   133 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                w </span><span class="r14">+=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                         </span> |
|<span class="r6">   134 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   135 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            done </span><span class="r14">=</span><span class="r9"> </span><span class="r8">False</span><span class="r11">                                                       </span> |
|<span class="r6">   136 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            h </span><span class="r14">=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                              </span> |
|<span class="r6">   137 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            </span><span class="r8">while</span><span class="r9"> (h </span><span class="r14">+</span><span class="r9"> j) </span><span class="r14">&lt;</span><span class="r9"> dims[axis2]:</span><span class="r11">                                       </span> |
|<span class="r6">   138 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                </span><span class="r8">for</span><span class="r9"> k </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(w):</span><span class="r11">                                             </span> |
|<span class="r6">   139 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                    </span><span class="r8">if</span><span class="r9"> </span><span class="r16">not</span><span class="r9"> (mask[n </span><span class="r14">+</span><span class="r9"> k </span><span class="r14">+</span><span class="r9"> h </span><span class="r14">*</span><span class="r9"> dims[axis1]] </span><span class="r14">==</span><span class="r9"> current_mask):</span><span class="r11">    </span> |
|<span class="r6">   140 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                        done </span><span class="r14">=</span><span class="r9"> </span><span class="r8">True</span><span class="r11">                                            </span> |
|<span class="r6">   141 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                        </span><span class="r8">break</span><span class="r11">                                                  </span> |
|<span class="r6">   142 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                </span><span class="r8">if</span><span class="r9"> done:</span><span class="r11">                                                       </span> |
|<span class="r6">   143 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                    </span><span class="r8">break</span><span class="r11">                                                      </span> |
|<span class="r6">   144 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                h </span><span class="r14">+=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                         </span> |
|<span class="r6">   145 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   146 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            offset </span><span class="r14">=</span><span class="r9"> Vector3(block_offset)</span><span class="r11">                                     </span> |
|<span class="r6">   147 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            offset[axis1] </span><span class="r14">+=</span><span class="r9"> i</span><span class="r11">                                                 </span> |
|<span class="r6">   148 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            offset[axis2] </span><span class="r14">+=</span><span class="r9"> j</span><span class="r11">                                                 </span> |
|<span class="r6">   149 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            offset[axis] </span><span class="r14">+=</span><span class="r9"> pos[axis]</span><span class="r11">                                          </span> |
|<span class="r6">   150 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            pos[axis1] </span><span class="r14">=</span><span class="r9"> i</span><span class="r11">                                                     </span> |
|<span class="r6">   151 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            pos[axis2] </span><span class="r14">=</span><span class="r9"> j</span><span class="r11">                                                     </span> |
|<span class="r6">   152 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            du </span><span class="r14">=</span><span class="r9"> Vector3(</span><span class="r14">0</span><span class="r9">)</span><span class="r11">                                                    </span> |
|<span class="r6">   153 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            dv </span><span class="r14">=</span><span class="r9"> Vector3(</span><span class="r14">0</span><span class="r9">)</span><span class="r11">                                                    </span> |
|<span class="r6">   154 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   155 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            </span><span class="r8">if</span><span class="r9"> current_mask </span><span class="r14">&gt;</span><span class="r9"> </span><span class="r14">0</span><span class="r9">:</span><span class="r11">                                               </span> |
|<span class="r6">   156 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                du[axis1] </span><span class="r14">=</span><span class="r9"> w</span><span class="r11">                                                  </span> |
|<span class="r6">   157 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                dv[axis2] </span><span class="r14">=</span><span class="r9"> h</span><span class="r11">                                                  </span> |
|<span class="r6">   158 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            </span><span class="r8">else</span><span class="r9">:</span><span class="r11">                                                              </span> |
|<span class="r6">   159 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                du[axis2] </span><span class="r14">=</span><span class="r9"> h</span><span class="r11">                                                  </span> |
|<span class="r6">   160 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                dv[axis1] </span><span class="r14">=</span><span class="r9"> w</span><span class="r11">                                                  </span> |
|<span class="r6">   161 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   162 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            normal_index </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">get_quad_normal_index(axis, current_mask)</span><span class="r11">      </span> |
|<span class="r6">   163 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   164 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            quads</span><span class="r14">.</span><span class="r9">append([</span><span class="r11">                                                     </span> |
|<span class="r6">   165 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                [</span><span class="r11">                                                              </span> |
|<span class="r6">   166 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                    offset,</span><span class="r11">                                                    </span> |
|<span class="r6">   167 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                    offset </span><span class="r14">+</span><span class="r9"> du,</span><span class="r11">                                               </span> |
|<span class="r6">   168 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                    offset </span><span class="r14">+</span><span class="r9"> du </span><span class="r14">+</span><span class="r9"> dv,</span><span class="r11">                                          </span> |
|<span class="r6">   169 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                    offset </span><span class="r14">+</span><span class="r9"> dv</span><span class="r11">                                                </span> |
|<span class="r6">   170 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                    ],</span><span class="r11">                                                         </span> |
|<span class="r6">   171 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                normal_index</span><span class="r11">                                                   </span> |
|<span class="r6">   172 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                ])</span><span class="r11">                                                             </span> |
|<span class="r6">   173 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   174 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            </span><span class="r8">for</span><span class="r9"> a </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(h):</span><span class="r11">                                                 </span> |
|<span class="r6">   175 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                </span><span class="r8">for</span><span class="r9"> b </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(w):</span><span class="r11">                                             </span> |
|<span class="r6">   176 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                                    mask[n </span><span class="r14">+</span><span class="r9"> b </span><span class="r14">+</span><span class="r9"> a </span><span class="r14">*</span><span class="r9"> dims[axis1]] </span><span class="r14">=</span><span class="r9"> </span><span class="r8">False</span><span class="r11">                      </span> |
|<span class="r6">   177 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   178 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            i </span><span class="r14">+=</span><span class="r9"> w</span><span class="r11">                                                             </span> |
|<span class="r6">   179 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            n </span><span class="r14">+=</span><span class="r9"> w</span><span class="r11">                                                             </span> |
|<span class="r6">   180 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        </span><span class="r8">else</span><span class="r9">:</span><span class="r11">                                                                  </span> |
|<span class="r6">   181 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            i </span><span class="r14">+=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                             </span> |
|<span class="r6">   182 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                            n </span><span class="r14">+=</span><span class="r9"> </span><span class="r14">1</span><span class="r11">                                                             </span> |
|<span class="r6">   183 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   184 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> quads</span><span class="r11">                                                                           </span> |
|<span class="r6">   185 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   186 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">update_mesh_buffer</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, chunk_pos</span><span class="r14">=</span><span class="r8">None</span><span class="r9">):</span><span class="r11">                                              </span> |
|<span class="r6">   187 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">if</span><span class="r9"> chunk_pos </span><span class="r16">is</span><span class="r9"> </span><span class="r8">None</span><span class="r9">:</span><span class="r11">                                                                  </span> |
|<span class="r6">   188 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">for</span><span class="r9"> chunk_pos </span><span class="r16">in</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">chunks:</span><span class="r11">                                                      </span> |
|<span class="r6">   189 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r13">self</span><span class="r14">.</span><span class="r9">mesh_buffer[</span><span class="r13">tuple</span><span class="r9">(chunk_pos)] </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">greedy_mesh(chunk_pos)</span><span class="r11">               </span> |
|<span class="r6">   190 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">else</span><span class="r9">:</span><span class="r11">                                                                                  </span> |
|<span class="r6">   191 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r13">self</span><span class="r14">.</span><span class="r9">mesh_buffer[</span><span class="r13">tuple</span><span class="r9">(chunk_pos)] </span><span class="r14">=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">greedy_mesh(chunk_pos)</span><span class="r11">                   </span> |
|<span class="r6">   192 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|                                                                                                |
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r20">function summary for C:\Users\PC\Documents\minecraft_pygame\chunk_sys.py                       </span> |
|<span class="r6">    28 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">ChunkSys</span><span class="r14">.</span><span class="r9">pos_to_chunk_scale</span><span class="r11">                                                                    </span> |
|<span class="r6">    51 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">ChunkSys</span><span class="r14">.</span><span class="r9">get_block</span><span class="r11">                                                                             </span> |
|<span class="r6">    88 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">ChunkSys</span><span class="r14">.</span><span class="r9">greedy_mesh</span><span class="r11">                                                                           </span> |
+---------------------------------------------------------------------------------------------------------------------------------+
<span class="r1">                       C:\Users\PC\Documents\minecraft_pygame\matrix.py: % of time =   1.63% out of  12.13s.                       </span>
+---------------------------------------------------------------------------------------------------------------------------------+
|<span class="r2">       </span>|<span class="r3">Time</span><span class="r2">    </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r3">––––––</span><span class="r2"> </span>|<span class="r2">                                                                                                </span>|
|<span class="r2"> </span><span class="r4">Line</span><span class="r2">  </span>|<span class="r5">Python</span><span class="r2">  </span>|<span class="r5">native</span><span class="r2"> </span>|<span class="r5">system</span><span class="r2"> </span>|<span class="r2">C:\Users\PC\Documents\minecraft_pygame\matrix.py                                                </span>|
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">     1 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">math</span><span class="r11">                                                                                    </span> |
|<span class="r6">     2 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">import</span><span class="r9"> </span><span class="r10">constants</span><span class="r9"> </span><span class="r8">as</span><span class="r9"> </span><span class="r10">CONSTANTS</span><span class="r11">                                                                  </span> |
|<span class="r6">     3 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     4 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">from</span><span class="r9"> </span><span class="r10">pygame</span><span class="r9"> </span><span class="r8">import</span><span class="r9"> Vector3</span><span class="r11">                                                                     </span> |
|<span class="r6">     5 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     6 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">     7 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">class</span><span class="r9"> </span><span class="r10">Mat4</span><span class="r9">:</span><span class="r11">                                                                                    </span> |
|<span class="r6">     8 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r17">__slots__</span><span class="r9"> </span><span class="r14">=</span><span class="r9"> [</span><span class="r18">&#x27;rows&#x27;</span><span class="r9">, </span><span class="r18">&#x27;cols&#x27;</span><span class="r9">, </span><span class="r18">&#x27;mat&#x27;</span><span class="r9">]</span><span class="r11">                                                        </span> |
|<span class="r6">     9 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    10 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">__init__</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, mat):</span><span class="r11">                                                                   </span> |
|<span class="r6">    11 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">mat </span><span class="r14">=</span><span class="r9"> mat </span><span class="r11">                                                                        </span> |
|<span class="r6">    12 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols </span><span class="r14">=</span><span class="r9"> [</span><span class="r11">                                                                          </span> |
|<span class="r6">    13 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                 (Vector3((mat[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">0</span><span class="r9">], mat[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">0</span><span class="r9">], mat[</span><span class="r14">2</span><span class="r9">][</span><span class="r14">0</span><span class="r9">])), mat[</span><span class="r14">3</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]),</span><span class="r11">                      </span> |
|<span class="r6">    14 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                 (Vector3((mat[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">1</span><span class="r9">], mat[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">1</span><span class="r9">], mat[</span><span class="r14">2</span><span class="r9">][</span><span class="r14">1</span><span class="r9">])), mat[</span><span class="r14">3</span><span class="r9">][</span><span class="r14">1</span><span class="r9">]),</span><span class="r11">                      </span> |
|<span class="r6">    15 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                 (Vector3((mat[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">2</span><span class="r9">], mat[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">2</span><span class="r9">], mat[</span><span class="r14">2</span><span class="r9">][</span><span class="r14">2</span><span class="r9">])), mat[</span><span class="r14">3</span><span class="r9">][</span><span class="r14">2</span><span class="r9">]),</span><span class="r11">                      </span> |
|<span class="r6">    16 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                 (Vector3((mat[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">3</span><span class="r9">], mat[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">3</span><span class="r9">], mat[</span><span class="r14">2</span><span class="r9">][</span><span class="r14">3</span><span class="r9">])), mat[</span><span class="r14">3</span><span class="r9">][</span><span class="r14">3</span><span class="r9">])</span><span class="r11">                       </span> |
|<span class="r6">    17 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">             ]</span><span class="r11">                                                                                 </span> |
|<span class="r6">    18 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    19 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">vec_dot</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, vec):</span><span class="r11">                                                                    </span> |
|<span class="r6">    20 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9">  (</span><span class="r11">                                                                              </span> |
|<span class="r6">    21 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                Vector3(</span><span class="r11">                                                                       </span> |
|<span class="r6">    22 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    vec</span><span class="r14">.</span><span class="r9">dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]) </span><span class="r14">+</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">1</span><span class="r9">],</span><span class="r11">                                </span> |
|<span class="r6">    23 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    vec</span><span class="r14">.</span><span class="r9">dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]) </span><span class="r14">+</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">1</span><span class="r9">],</span><span class="r11">                                </span> |
|<span class="r6">    24 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    vec</span><span class="r14">.</span><span class="r9">dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">2</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]) </span><span class="r14">+</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">2</span><span class="r9">][</span><span class="r14">1</span><span class="r9">],</span><span class="r11">                                </span> |
|<span class="r6">    25 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        ),</span><span class="r11">                                                                     </span> |
|<span class="r6">    26 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    vec</span><span class="r14">.</span><span class="r9">dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">3</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]) </span><span class="r14">+</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">3</span><span class="r9">][</span><span class="r14">1</span><span class="r9">]</span><span class="r11">                                 </span> |
|<span class="r6">    27 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                )</span><span class="r11">                                                                              </span> |
|<span class="r6">    28 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    29 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">vec_dot2</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, vec):</span><span class="r11">                                                                   </span> |
|<span class="r6">    30 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        v </span><span class="r14">=</span><span class="r9"> vec[</span><span class="r14">0</span><span class="r9">]</span><span class="r11">                                                                             </span> |
|<span class="r6">    31 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        w </span><span class="r14">=</span><span class="r9"> vec[</span><span class="r14">1</span><span class="r9">]</span><span class="r11">                                                                             </span> |
|<span class="r6">    32 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> (</span><span class="r11">                                                                               </span> |
|<span class="r6">    33 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                Vector3(</span><span class="r11">                                                                       </span> |
|<span class="r6">    34 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    v</span><span class="r14">.</span><span class="r9">dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]) </span><span class="r14">+</span><span class="r9"> w </span><span class="r14">*</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">1</span><span class="r9">],</span><span class="r11">                              </span> |
|<span class="r6">    35 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    v</span><span class="r14">.</span><span class="r9">dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]) </span><span class="r14">+</span><span class="r9"> w </span><span class="r14">*</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">1</span><span class="r9">],</span><span class="r11">                              </span> |
|<span class="r6">    36 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    v</span><span class="r14">.</span><span class="r9">dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">2</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]) </span><span class="r14">+</span><span class="r9"> w </span><span class="r14">*</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">2</span><span class="r9">][</span><span class="r14">1</span><span class="r9">],</span><span class="r11">                              </span> |
|<span class="r6">    37 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                        ),</span><span class="r11">                                                                     </span> |
|<span class="r6">    38 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    v</span><span class="r14">.</span><span class="r9">dot(</span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">3</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]) </span><span class="r14">+</span><span class="r9"> w </span><span class="r14">*</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">cols[</span><span class="r14">3</span><span class="r9">][</span><span class="r14">1</span><span class="r9">]</span><span class="r11">                               </span> |
|<span class="r6">    39 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                )</span><span class="r11">                                                                              </span> |
|<span class="r6">    40 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    41 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">def</span><span class="r9"> </span><span class="r12">mat4_dot</span><span class="r9">(</span><span class="r13">self</span><span class="r9">, mat):</span><span class="r11">                                                                   </span> |
|<span class="r6">    42 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        new_mat </span><span class="r14">=</span><span class="r9"> [[</span><span class="r14">0</span><span class="r9"> </span><span class="r8">for</span><span class="r9"> _ </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r14">4</span><span class="r9">)] </span><span class="r8">for</span><span class="r9"> _ </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r14">4</span><span class="r9">)]</span><span class="r11">                                    </span> |
|<span class="r6">    43 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> i </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r14">4</span><span class="r9">):</span><span class="r11">                                                                     </span> |
|<span class="r6">    44 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            </span><span class="r8">for</span><span class="r9"> j </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r14">4</span><span class="r9">):</span><span class="r11">                                                                 </span> |
|<span class="r6">    45 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                </span><span class="r8">for</span><span class="r9"> k </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r14">4</span><span class="r9">):</span><span class="r11">                                                             </span> |
|<span class="r6">    46 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                    new_mat[i][j] </span><span class="r14">+=</span><span class="r9"> </span><span class="r13">self</span><span class="r14">.</span><span class="r9">mat[i][k] </span><span class="r14">*</span><span class="r9"> mat</span><span class="r14">.</span><span class="r9">mat[k][j]</span><span class="r11">                            </span> |
|<span class="r6">    47 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> Mat4(new_mat)</span><span class="r11">                                                                   </span> |
|<span class="r6">    48 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    49 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    50 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    51 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">transposeMatrix</span><span class="r9">(m):</span><span class="r11">                                                                        </span> |
|<span class="r6">    52 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> </span><span class="r13">map</span><span class="r9">(</span><span class="r13">list</span><span class="r9">,</span><span class="r13">zip</span><span class="r9">(</span><span class="r14">*</span><span class="r9">m))</span><span class="r11">                                                                   </span> |
|<span class="r6">    53 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    54 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">getMatrixMinor</span><span class="r9">(m,i,j):</span><span class="r11">                                                                     </span> |
|<span class="r6">    55 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> [row[:j] </span><span class="r14">+</span><span class="r9"> row[j</span><span class="r14">+1</span><span class="r9">:] </span><span class="r8">for</span><span class="r9"> row </span><span class="r16">in</span><span class="r9"> (m[:i]</span><span class="r14">+</span><span class="r9">m[i</span><span class="r14">+1</span><span class="r9">:])]</span><span class="r11">                                    </span> |
|<span class="r6">    56 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    57 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">getMatrixDeternminant</span><span class="r9">(m):</span><span class="r11">                                                                  </span> |
|<span class="r6">    58 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">if</span><span class="r9"> </span><span class="r13">len</span><span class="r9">(m) </span><span class="r14">==</span><span class="r9"> </span><span class="r14">2</span><span class="r9">:</span><span class="r11">                                                                            </span> |
|<span class="r6">    59 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> m[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]</span><span class="r14">*</span><span class="r9">m[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">1</span><span class="r9">]</span><span class="r14">-</span><span class="r9">m[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">1</span><span class="r9">]</span><span class="r14">*</span><span class="r9">m[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]</span><span class="r11">                                                 </span> |
|<span class="r6">    60 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    61 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    determinant </span><span class="r14">=</span><span class="r9"> </span><span class="r14">0</span><span class="r11">                                                                            </span> |
|<span class="r6">    62 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">for</span><span class="r9"> c </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r13">len</span><span class="r9">(m)):</span><span class="r11">                                                                    </span> |
|<span class="r6">    63 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        determinant </span><span class="r14">+=</span><span class="r9"> ((</span><span class="r14">-1</span><span class="r9">)</span><span class="r14">**</span><span class="r9">c)</span><span class="r14">*</span><span class="r9">m[</span><span class="r14">0</span><span class="r9">][c]</span><span class="r14">*</span><span class="r9">getMatrixDeternminant(getMatrixMinor(m,</span><span class="r14">0</span><span class="r9">,c))</span><span class="r11">          </span> |
|<span class="r6">    64 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> determinant</span><span class="r11">                                                                         </span> |
|<span class="r6">    65 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    66 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">getMatrixInverse</span><span class="r9">(m):</span><span class="r11">                                                                       </span> |
|<span class="r6">    67 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    m </span><span class="r14">=</span><span class="r9"> m</span><span class="r14">.</span><span class="r9">mat</span><span class="r11">                                                                                  </span> |
|<span class="r6">    68 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    determinant </span><span class="r14">=</span><span class="r9"> getMatrixDeternminant(m)</span><span class="r11">                                                     </span> |
|<span class="r6">    69 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">if</span><span class="r9"> </span><span class="r13">len</span><span class="r9">(m) </span><span class="r14">==</span><span class="r9"> </span><span class="r14">2</span><span class="r9">:</span><span class="r11">                                                                            </span> |
|<span class="r6">    70 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> [[m[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">1</span><span class="r9">]</span><span class="r14">/</span><span class="r9">determinant, </span><span class="r14">-1*</span><span class="r9">m[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">1</span><span class="r9">]</span><span class="r14">/</span><span class="r9">determinant],</span><span class="r11">                                 </span> |
|<span class="r6">    71 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">                [</span><span class="r14">-1*</span><span class="r9">m[</span><span class="r14">1</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]</span><span class="r14">/</span><span class="r9">determinant, m[</span><span class="r14">0</span><span class="r9">][</span><span class="r14">0</span><span class="r9">]</span><span class="r14">/</span><span class="r9">determinant]]</span><span class="r11">                                 </span> |
|<span class="r6">    72 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    73 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    cofactors </span><span class="r14">=</span><span class="r9"> []</span><span class="r11">                                                                             </span> |
|<span class="r6">    74 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">for</span><span class="r9"> r </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r13">len</span><span class="r9">(m)):</span><span class="r11">                                                                    </span> |
|<span class="r6">    75 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        cofactorRow </span><span class="r14">=</span><span class="r9"> []</span><span class="r11">                                                                       </span> |
|<span class="r6">    76 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> c </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r13">len</span><span class="r9">(m)):</span><span class="r11">                                                                </span> |
|<span class="r6">    77 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            minor </span><span class="r14">=</span><span class="r9"> getMatrixMinor(m,r,c)</span><span class="r11">                                                      </span> |
|<span class="r6">    78 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            cofactorRow</span><span class="r14">.</span><span class="r9">append(((</span><span class="r14">-1</span><span class="r9">)</span><span class="r14">**</span><span class="r9">(r</span><span class="r14">+</span><span class="r9">c)) </span><span class="r14">*</span><span class="r9"> getMatrixDeternminant(minor))</span><span class="r11">                   </span> |
|<span class="r6">    79 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        cofactors</span><span class="r14">.</span><span class="r9">append(cofactorRow)</span><span class="r11">                                                          </span> |
|<span class="r6">    80 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    cofactors </span><span class="r14">=</span><span class="r9"> </span><span class="r13">list</span><span class="r9">(transposeMatrix(cofactors))</span><span class="r11">                                               </span> |
|<span class="r6">    81 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">for</span><span class="r9"> r </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r13">len</span><span class="r9">(cofactors)):</span><span class="r11">                                                            </span> |
|<span class="r6">    82 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">for</span><span class="r9"> c </span><span class="r16">in</span><span class="r9"> </span><span class="r13">range</span><span class="r9">(</span><span class="r13">len</span><span class="r9">(cofactors)):</span><span class="r11">                                                        </span> |
|<span class="r6">    83 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            cofactors[r][c] </span><span class="r14">=</span><span class="r9"> cofactors[r][c]</span><span class="r14">/</span><span class="r9">determinant</span><span class="r11">                                      </span> |
|<span class="r6">    84 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> Mat4(cofactors)</span><span class="r11">                                                                     </span> |
|<span class="r6">    85 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    86 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    87 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">get_yaw</span><span class="r9">(angle):</span><span class="r11">                                                                            </span> |
|<span class="r6">    88 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    cos </span><span class="r14">=</span><span class="r9"> math</span><span class="r14">.</span><span class="r9">cos(angle)</span><span class="r11">                                                                      </span> |
|<span class="r6">    89 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    sin </span><span class="r14">=</span><span class="r9"> math</span><span class="r14">.</span><span class="r9">sin(angle)</span><span class="r11">                                                                      </span> |
|<span class="r6">    90 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> Mat4([</span><span class="r11">                                                                              </span> |
|<span class="r6">    91 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        [cos, sin, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                                  </span> |
|<span class="r6">    92 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        [</span><span class="r14">-</span><span class="r9">sin, cos, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                                 </span> |
|<span class="r6">    93 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        [</span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">1</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                                    </span> |
|<span class="r6">    94 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        [</span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">1</span><span class="r9">],</span><span class="r11">                                                                    </span> |
|<span class="r6">    95 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    ])</span><span class="r11">                                                                                         </span> |
|<span class="r6">    96 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    97 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">    98 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">get_roll</span><span class="r9">(angle):</span><span class="r11">                                                                           </span> |
|<span class="r6">    99 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        cos </span><span class="r14">=</span><span class="r9"> math</span><span class="r14">.</span><span class="r9">cos(angle)</span><span class="r11">                                                                  </span> |
|<span class="r6">   100 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        sin </span><span class="r14">=</span><span class="r9"> math</span><span class="r14">.</span><span class="r9">sin(angle)</span><span class="r11">                                                                  </span> |
|<span class="r6">   101 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> Mat4([</span><span class="r11">                                                                          </span> |
|<span class="r6">   102 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [</span><span class="r14">1</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                                </span> |
|<span class="r6">   103 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [</span><span class="r14">0.0</span><span class="r9">, cos, sin, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                              </span> |
|<span class="r6">   104 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [</span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">-</span><span class="r9">sin, cos, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                             </span> |
|<span class="r6">   105 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [</span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">1</span><span class="r9">],</span><span class="r11">                                                                </span> |
|<span class="r6">   106 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        ])</span><span class="r11">                                                                                     </span> |
|<span class="r6">   107 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   108 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">get_pitch</span><span class="r9">(angle):</span><span class="r11">                                                                          </span> |
|<span class="r6">   109 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    cos </span><span class="r14">=</span><span class="r9"> math</span><span class="r14">.</span><span class="r9">cos(angle)</span><span class="r11">                                                                      </span> |
|<span class="r6">   110 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    sin </span><span class="r14">=</span><span class="r9"> math</span><span class="r14">.</span><span class="r9">sin(angle)</span><span class="r11">                                                                      </span> |
|<span class="r6">   111 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    </span><span class="r8">return</span><span class="r9"> Mat4([</span><span class="r11">                                                                              </span> |
|<span class="r6">   112 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        [cos, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">-</span><span class="r9">sin, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                                 </span> |
|<span class="r6">   113 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        [</span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">1</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                                    </span> |
|<span class="r6">   114 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        [sin, </span><span class="r14">0.0</span><span class="r9">, cos, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                                  </span> |
|<span class="r6">   115 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        [</span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">1</span><span class="r9">],</span><span class="r11">                                                                    </span> |
|<span class="r6">   116 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">    ])</span><span class="r11">                                                                                         </span> |
|<span class="r6">   117 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   118 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">   119 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r8">def</span><span class="r9"> </span><span class="r12">get_translation_mat</span><span class="r9">(x, y, z):</span><span class="r11">                                                              </span> |
|<span class="r6">   120 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">        </span><span class="r8">return</span><span class="r9"> Mat4([</span><span class="r11">                                                                          </span> |
|<span class="r6">   121 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [</span><span class="r14">1.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                              </span> |
|<span class="r6">   122 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [</span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">1.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                              </span> |
|<span class="r6">   123 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [</span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">, </span><span class="r14">1.0</span><span class="r9">, </span><span class="r14">0.0</span><span class="r9">],</span><span class="r11">                                                              </span> |
|<span class="r6">   124 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            [x, y, z, </span><span class="r14">1.0</span><span class="r9">]</span><span class="r11">                                                                     </span> |
|<span class="r6">   125 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">            ])</span><span class="r11">                                                                                 </span> |
|<span class="r6">   126 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r11">                                                                                               </span> |
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|                                                                                                |
|-------+--------+-------+-------+------------------------------------------------------------------------------------------------|
|<span class="r6">       </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r20">function summary for C:\Users\PC\Documents\minecraft_pygame\matrix.py                          </span> |
|<span class="r6">    19 </span>|<span class="r7">        </span>|<span class="r7">       </span>|<span class="r7">       </span>|<span class="r9">Mat4</span><span class="r14">.</span><span class="r9">vec_dot</span><span class="r11">                                                                                   </span> |
+---------------------------------------------------------------------------------------------------------------------------------+
generated by the <a class="r23" href="https://github.com/plasma-umass/scalene">scalene</a> profiler                                                                                                   
</pre>
    </code>
</body>
</html>
